{{template "base.html" .}}

{{define "title"}}Todos{{end}}

{{define "content"}}
<h2 class="text-xl py-2">Todo list</h2>

<table id="todo-list" class="mt-2 min-w-full divide-y divide-gray-300">
	<thead class="bg-gray-50">
		<tr>
			<th scope="col" class="px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
				Todo
			</th>
			<th scope="col" class="px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
				Done?
			</th>
			<th scope="col" class="px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
			</th>
		</tr>
	</thead>
	<tbody class="bg-white divide-y divide-gray-200">
		{{range .Todos}}
			{{template "todo-list-item.html" .}}
		{{end}}
	</tbody>
	<tfoot>
		<tr>
			{{template "todo-list-number.html" .}}
		<tr>
			<td
				colspan="3"
				class="px-4 py-2 text-sm font-medium text-gray-500 uppercase flex gap-2">
				<p>Show:</p>
				<ul
					hx-boost="true"
					class="flex divide-x">
					{{range .Filters}}
						<li class="px-4">
							<a
								href="./{{if .Value}}?filter={{.Value}}{{end}}"
								class="{{if .Active}}font-bold {{end}}hover:text-gray-700">
								{{.Label}}
							</a>
						</li>
					{{end}}
				</ul>
			</td>
		</tr>
	</tfoot>
</table>

<style>
.htmx-swapping {
	opacity: 0;
	transition: opacity 1s ease-out;
}
</style>

<form 
	hx-post="/todos/"
	hx-target="#todo-list tbody"
	hx-swap="beforeend"
	class="flex items-end gap-2 border-t mt-4 py-4">
	<fieldset class="flex-grow">
		<label for="new-todo" class="block text-sm font-medium text-gray-700">New todo</label>
		<input type="text" id="new-todo" name="new-todo" placeholder="What to do &hellip;" required autofocus
			   class="mt-1 px-4 py-4 focus:ring-indigo-500 focus:border-indigo-500 w-full shadow-sm border border-gray-300 rounded-md">
	</fieldset>
	<input type="submit" value="Add"
		class="px-4 py-4 border border-transparent shadow-sm font-medium rounded-md text-white bg-indigo-700">
</form>
<script>
	document.addEventListener("htmx:afterRequest", () => {
		document.querySelector("#new-todo").value = '';
	}, false);
</script>
{{end}}
